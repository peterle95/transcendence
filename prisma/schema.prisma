// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma" // tells where prisma code will be put
}

datasource db {
  provider = "postgresql"
}

// HOW TO USE PRISMA:
// --> every time changes are made to the schema, migrate prisma to the database:
// npx prisma migrate dev (optional with a name like: npx prisma migrate dev --name [name])
// npx prisma migrate deploy (when ready for deployment)
// --> then generate the prisma client which is the bridge between the code and the database:
// npx prisma generate
// --> For running the test file:
// npx tsx src/app/prisma.ts
// --> for a GUI to view the database:
// npx prisma studio

model User {
  // id is
  // @id is a field attribute and is the primary key, a primary key is a unique identifier for each user
  // there can only be one primary key per model 
  // @default(autoincrement()) means it will automatically increment the id when a new user is created
  id Int @id @default(autoincrement())
  name String
  email String
  isAdmin Boolean @default(false)
  largeNumber BigInt
  data Json @default("{ \"hello\": \"world\"}")
  role Role @default(BASIC)
  age Int // ? means it's optional
  Game Game[] // one-to-may relation
  Userpage Userpage? // one-to-one relation (one userpage per user)

  @@unique([name, email]) 
  // this is called a block attribute and it creates a unique constraint on the name and email fields
  // meaning that no two users can have the same name and email
}

model Userpage {
  userId Int @unique // foreign key
  user User @relation(fields: [userId], references: [id]) // relation to User
  points Int 
  wins Int @default(0)
  losses Int @default(0)
}

model Game {
  gameId Int @id @default(autoincrement())
  playerId Int // foreign key
  player User @relation(fields: [playerId], references: [id]) // creates a many-to-one relation (one player to many games)
}

// enums define a set of allowed string values
// for example: 
enum Role {
  BASIC
  ADMIN
}